/*
===============================================================================================================================
                          ULTIMAS ATUALIZAÇÕES EFETUADAS - CONSULTAR LOG DO VERSIONADOR PARA HISTORICO COMPLETO
===============================================================================================================================
   Autor      |    Data    |                                             Motivo                                          
-------------------------------------------------------------------------------------------------------------------------------
Alex Wallauer | 28/07/2021 | Correcao para mostrar a descricao correta do produto. Chamado 37205
-------------------------------------------------------------------------------------------------------------------------------
===============================================================================================================================
*/

//====================================================================================================
// Definicoes de Includes da Rotina.
//====================================================================================================

/*
===============================================================================================================================
Programa----------: A650OPI
Autor-------------: Alex Wallauer
Data da Criacao---: 21/12/2018
===============================================================================================================================
Descrição---------: PE para gerar ou nao OPs intermediarias - Chamado 27300
===============================================================================================================================
Parametros--------: PARAMIXB = nSG1
===============================================================================================================================
Retorno-----------: Nenhum
===============================================================================================================================
*/
User Function A650OPI()

//LOCAL nSG1:=PARAMIXB
//LOCAL nPos1:=aScan(aHeader,{|x| AllTrim(x[2])=="G1_COMP"})
//LOCAL nPos2:=aScan(aHeader,{|x| AllTrim(x[2])=="B1_DESC"})
LOCAL cDesc:=""

//F nPos1 > 0 .AND. nPos2 > 0 .AND. nSG1 > 0
   cDesc:=ALLTRIM(SB1->B1_COD)+" - "+ALLTRIM(SB1->B1_DESC)//ALLTRIM(aCols[nSG1,nPos1])+" - "+ALLTRIM(aCols[nSG1,nPos2])
//ENDIF

RETURN U_ITMSG("GERAR OP do Produto "+cDesc+" ? ",'Atenção!',,2,2,2)
