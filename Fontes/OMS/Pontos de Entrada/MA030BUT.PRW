/*
===============================================================================================================================
               ULTIMAS ATUALIZAÇÕES EFETUADAS - CONSULTAR LOG DO VERSIONADOR PARA HISTORICO COMPLETO
===============================================================================================================================
       Autor      |    Data    |                                             Motivo                                           
-------------------------------------------------------------------------------------------------------------------------------
 Josué Danich     | 24/08/2018 | Inclusão de botão de análise de crédito - Chamado 25960
===============================================================================================================================
*/

//====================================================================================================
// Definicoes de Includes e Defines da Rotina.
//====================================================================================================

#Include "Protheus.Ch"
#include "RWMAKE.CH"
#INCLUDE "TopConn.ch"

/*
===============================================================================================================================
Programa----------: MA030BUT
Autor-------------: Alexandre Villar
Data da Criacao---: 17/06/2014
===============================================================================================================================
Descrição---------: Ponto de entrada para guardar os dados do cadastro do Cliente antes da alteração.
===============================================================================================================================
Parametros--------: Nenhum
===============================================================================================================================
Retorno-----------: aBtnUsr - Array para inclusão de botões na tela de manutenção do cadastro de Clientes
===============================================================================================================================
*/

User Function MA030BUT()

Local 	nOpcA		:= ParamIxb[01]
Local 	aBtnUsr		:= {}
Local cMatUsr		:= U_UCFG001(1) 

//================================================================================
//| Inclui botoes na tela do cadastro de clientes se não for inclusão            |
//================================================================================
If	nOpcA != 3
	aAdd( aBtnUsr , { "Alteracoes" , {|| U_COMS004() } , "Historico de Alteracoes" , "Alteracoes" } )
	
	//Se é usuário do crédito inclui botão de análise de crédito
	If GetAdvFVal( "ZZL" , "ZZL_LIBCRE" , xFilial("ZZL") + cMatUsr , 1 , "N" ) == "S"
	
		aAdd( aBtnUsr , { "An Credito" , {|| U_Ctelcred() } , "Analise de Credito" , "An Credito" } )
	
	Endif
	
EndIf

//================================================================================
//| Caso a chamada seja de alteração, guarda os valores originais dos campos     |
//================================================================================
If nOpcA == 4
	Public _aITASA1 := U_ITINILOG( "SA1" )
EndIf

Return( aBtnUsr )

/*
===============================================================================================================================
Programa----------: Ctelcred
Autor-------------: Josué Danich Prestes
Data da Criacao---: 24/08/2018
===============================================================================================================================
Descrição---------: Chama consulta cisp para pedido de vendas
===============================================================================================================================
Parametros--------: Nenhum
===============================================================================================================================
Retorno-----------: nenhum
===============================================================================================================================
*/
User Function Ctelcred()

	fwmsgrun(,{ || U_TelCred(2)}, "Aguarde...","Realizando consulta Cisp...")

Return
